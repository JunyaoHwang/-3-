

<!-- Meanless: 第 12 卷 第 2 期 数学建模及其应用 Vol. 12 No. 2 2023 年 6 月 Mathematical Modeling and Its Applications Jun. 2023-->

教学与竞赛

# 基于成分数据的古代玻璃制品分析与分类

马佩莹,韩雁来,李德兰,陈佳佳

(山西财经大学 统计学院, 山西 太原 030006)

摘 要：古代玻璃制品的化学成分属于成分数据, 基于成分数据分析方法可以对玻璃制品的化学成分进行分析, 研究其分类规律,并对未知玻璃文物鉴别其所属类型. 首先,基于 Spearman 相关系数以及卡方检验分析玻璃文物表面风化与其类型、纹饰、颜色的关系；通过单形空间均值来分析玻璃表面有无风化化学成分含量的统计规律；构建 Dirichlet 回归模型来预测风化点风化前的化学成分含量. 其次, 构建决策树、偏最小二乘判别分析两种模型对两类玻璃进行初分类特征选择; 进一步, 用 K-means 聚类对两类玻璃进行亚分类, 并通过偏最小二乘判别分析对两类玻璃进行亚分类特征选择; 进而, 利用所得分类规律对未知类别玻璃鉴别其所属类型. 最后, 运用灰色关联分析分别探究两类玻璃化学成分之间的关联关系及其差异性.

关键词：成分数据；决策树；偏最小二乘判别分析；K-means 聚类；灰色关联

中图分类号：O29 文献标志码： $\mathrm{A}$ 文章编号：2095-3070(2023)02-0063-11

DOI: 10.19943/j. 2095-3070. jmmia. 2023. 02.06

## 0 引言

玻璃的发展历史悠久, 是人类最早发明的人造材料之一, 在中国经历了从舶来品到自主生产的过程. 玻璃外观虽相似,但根据其添加的助熔剂不同,其主要化学成分也不同 ${}^{\left\lbrack  1 - 2\right\rbrack  }$ . 根据一批我国古代玻璃制品的相关数据研究玻璃制品的化学成分及鉴别, 对古代玻璃文物的保护具有重要意义 ${}^{\left\lbrack  3\right\rbrack  }$ .

有学者根据中国古代玻璃的发展,将玻璃成分的演变分为 5 个阶段: 从春秋到战国前期的 ${\mathrm{K}}_{2}\mathrm{O} -$ $\mathrm{{CaO}} - {\mathrm{{SiO}}}_{2}$ 系统,其中 ${\mathrm{K}}_{2}\mathrm{O}/{\mathrm{{Na}}}_{2}\mathrm{O} > 1$ ; 从战国到东汉时期的 $\mathrm{{BaO}} - \mathrm{{PbO}} - {\mathrm{{SiO}}}_{2}$ 系统和 ${\mathrm{K}}_{2}\mathrm{O} - {\mathrm{{SiO}}}_{2}$ 系统; 从东汉到唐代时期的 $\mathrm{{PbO}} - {\mathrm{{SiO}}}_{2}$ 系统; 从唐代到元代时期的 ${\mathrm{K}}_{2}\mathrm{O} - \mathrm{{PbO}} - {\mathrm{{SiO}}}_{2}$ 系统; 从元代到清代时期的 ${\mathrm{K}}_{2}\mathrm{O} - \mathrm{{CaO}} - {\mathrm{{SiO}}}_{2}$ 系统 ${}^{\left\lbrack  4\right\rbrack  }$ . 主成分分析方法已经被大量应用于古代文物的具体成分研究中,特别是古陶瓷、古玻璃器化学成分的分析处理 ${}^{\left\lbrack  5\right\rbrack  }$ . 此外,一些学者采用外束质子激发 $\mathrm{X}$ 荧光技术 (PIXE)、电感耦合等离子体原子发射光谱分析(ICP AES)方法,对新疆、湖北等地区出土的一批战国时期的玻璃珠 (包含镶嵌玻璃珠)、玻璃壁样品进行检测 ${}^{\left\lbrack  6\right\rbrack  }$ . 史美光等 ${}^{\left\lbrack  7\right\rbrack  }$ 应用扫描电镜-能量色散 X 射线分析(SEM-EDX)、电感耦合等离子体发射光谱分析方法、密度测定和偏光显微镜观察等方法, 对十多件有代表性的钾硅玻璃样品进行了研究. 有学者采用光谱分析、同位素射线荧光分析和比重测试 3 种方法对西汉到北宋的 52 件玻璃样品进行了分析 ${}^{\left\lbrack  8\right\rbrack  }$ .

对玻璃化学成分的研究大多基于物理、化学方法对其成分进行判别并研究其演化历程, 仅有少数研究采用统计方法. 本文从统计视角出发, 基于成分数据 ${}^{\left\lbrack  9 - {10}\right\rbrack  }$ , 运用统计方法建立成分预测、玻璃分类及进一步亚分类的模型, 进而将这些模型推广, 运用至新发现玻璃的成分研究与分类, 有助于促进玻璃文物的保护和玻璃制品的生产制造.

---

<!-- Footnote -->

收稿日期：2023-01-19

基金项目：山西省高等学校教学改革创新项目(J20220570)

通讯作者：陈佳佳, E-mail: chenjiajia0401@163.com

引用格式：马佩莹, 韩雁来, 李德兰, 等. 基于成分数据的古代玻璃制品分析与分类[J]. 数学建模及其应用, 2023, ${12}\left( 2\right)  : {63} - {73}$

MAP Y, HAN Y L, LI D L, et al. Analysis and classification of ancient glass products based on compositional data(in Chinese)[J]. Mathematical Modeling and Its Applications, 2023, 12(2): 63-73.

<!-- Footnote -->

---

<!-- Meanless: · 63 · (C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net-->




<!-- Meanless: - 教学与竞赛· 基于成分数据的古代玻璃制品分析与分类 2023 年 6 月-->

## 1 模型假设

1)化学成分指采样点处的化学成分；

2)未检测到化学成分的原因是仪器精度受限,故暂时将化学成分缺失值记为 0 ,后续进行插补处理；

3)检测到的化学成分 0 值是由于四舍五入得到的,后续进行插补处理.

## 2 数据预处理

### 2.1 附表 1 数据预处理

附表 1 给出了玻璃文物编号、纹饰、类型、颜色和表面风化的基本信息. 由于数据量较大且存在一定的缺失值, 故对数据进行缺失值处理, 防止对后续建模产生不利影响. 其中缺失值均为玻璃文物颜色,按其他信息可分为 “纹饰 A、表面风化、铅钡” 和 “纹饰 C、表面风化、铅钡” 两类, 按此分别进行填补.

在所给文物中,符合 “纹饰 C、表面风化、铅钡” 条件并已知颜色的 15 件文物颜色分布如表 1 所示.

<!-- Media -->

表 1 颜色分布 I

<table><tr><td>颜色</td><td>蓝绿</td><td>浅蓝</td><td>浅绿</td><td>深绿</td><td>紫</td></tr><tr><td>对应文物编号</td><td>56,57</td><td>11,25,43,51,52,54</td><td>41</td><td>34,36,38,39</td><td>08,26</td></tr></table>

<!-- Media -->

因数据为定性数据, 故采用热卡来填充缺失值. 对 15 件文物及待填充的 40、58 号文物的化学成分进行比较, 用成分相似的文物颜色进行填充. 方法是: 一件文物在两个部位进行采样时取均值代表, 在一个部位和严重分化点采样时按 1 : 2 的权重计算后作为代表, 在一个部位和未分化点采样时将部位的化学成分作为代表. 经比较可知, 40 号与 39 号文物成分相似, 58 号与 51 号成分相似, 故将 40 和 58 号文物颜色分别填充为深绿和浅蓝.

<!-- Media -->

表 2 颜色分布 II

<table><tr><td>颜色</td><td>黑</td><td>蓝绿</td><td>浅蓝</td></tr><tr><td>对应文物编号</td><td>49,50</td><td>23</td><td>02,28,29,42,44,53</td></tr></table>

<!-- Media -->

符合 “纹饰 A、表面风化、铅钡” 条件并已知颜色的 9 件文物颜色如表 2 所示.

由附表 2 可知, 9 件文物中有 6 件文物采样点为未风化点, 所得到的成分含量可参考性较低, 故对此采用众数进行填补, 即 19 和 48 号文物颜色填充为浅蓝.

### 2.2 附表 2、3 数据预处理

累加和介于 85%~105% 之间的数据视为有效数据,故 15 号和 17 号文物为无效数据,将其剔除. 假设表单 2、3 中出现的空白为仪器精度受限未检测到该成分, 可看作近似零值; 另外, 假设表单 2、3 中的 0 值是由于四舍五入得到, 也可看作近似零值. 采用乘法替换对近似零值进行插补, 具体过程为如下.

考虑成分数据集

$$
\mathbf{X} = {\left\lbrack  {x}_{ij}\right\rbrack  }_{n \times  D} = \left( \begin{matrix} {x}_{11} & {x}_{12} & \cdots & {x}_{1D} \\  {x}_{21} & {x}_{22} & \cdots & {x}_{2D} \\  \vdots & \vdots & \vdots & \vdots \\  {x}_{n1} & {x}_{n2} & \cdots & {x}_{nD} \end{matrix}\right) , \tag{1}
$$

其中: $\mathbf{X}$ 中每一行为一个成分数据,每个成分数据含有 $D$ 个部分,如第 $i$ 行表示第 $i$ 个玻璃文物的化学成分数据; ${x}_{i,j}$ 表示第 $i$ 个玻璃文物的第 $j$ 个化学成分的含量. 假定成分数据中有近似零值,且不同成分数据相同部分对应的探测范围是相同的. 记探测范围向量为 $\mathbf{e} = {\left( {e}_{1},{e}_{2},\cdots ,{e}_{D}\right) }^{\mathrm{T}}$ ,其中, ${e}_{j}$ 为成分数据集 $\mathbf{X}$ 的第 $j$ 个部分对应的探测范围. 运用乘法简单替换法,对 ${x}_{ij}$ 替换后的数据为

(C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net

<!-- Meanless: - 64 .-->




<!-- Meanless: 第 12 卷 第 2 期 数学建模及其应用 Vol. 12 No. 2 Jun. 2023-->

$$
{\widehat{x}}_{ij} = \left\{  \begin{matrix} {\delta }_{ij}, & {x}_{ij} = 0, \\  {x}_{ij}\left\lbrack  {1 - \left( {\mathop{\sum }\limits_{{k \mid  {x}_{ik} = 0}}{\delta }_{ik}}\right) /c}\right\rbrack  , & {x}_{ij} > 0, \end{matrix}\right.  \tag{2}
$$

其中: ${\delta }_{ij}$ 为一个小于 ${e}_{j}$ 的数; $c$ 为成分数据的常数和约束,即 $\mathop{\sum }\limits_{{j = 1}}^{D}{x}_{ij} = c$ .

通过实验发现,当成分数据集中近似零值比例不高, ${\delta }_{ij}$ 等于探测范围的 ${65}\%$ 时插补效果最好,即 ${\delta }_{ij} = {0.65}{e}_{j}$ . 记附表 2、3 中空白处所在列的最小值为临界值,并将其乘以 0.65 ,得到插补值,如表 3 和表 4 所示 (仅列出部分插补值).

<!-- Media -->

表 3 表单 2 成分数据插补缺失值表 (部分) %

<table><tr><td>文物采样点</td><td>${\mathrm{{SiO}}}_{2}$</td><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>${\mathrm{{SnO}}}_{2}$</td><td>${\mathrm{{SO}}}_{2}$</td></tr><tr><td>01</td><td>69.3300</td><td>0.5275</td><td>9. 9900</td><td>0.1517</td><td>0.3900</td></tr><tr><td>03 部位 1</td><td>87. 0500</td><td>0.5287</td><td>5. 1900</td><td>0.1520</td><td>0.0727</td></tr><tr><td>03 部位 2</td><td>61.7100</td><td>0.5239</td><td>12.3700</td><td>0.1506</td><td>0.0720</td></tr><tr><td>57</td><td>25.4200</td><td>0.5264</td><td>0.0724</td><td>0.1513</td><td>0.0724</td></tr><tr><td>58</td><td>30. 3900</td><td>0.5239</td><td>0.3400</td><td>0.1506</td><td>0.0720</td></tr></table>

表 4 表单 3 成分数据插补缺失值表 (部分) %

<table><tr><td>文物编号</td><td>表面风化</td><td>${\mathrm{{SiO}}}_{2}$</td><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>${\mathrm{{SnO}}}_{2}$</td><td>${\mathrm{{SO}}}_{2}$</td></tr><tr><td>A1</td><td>无风化</td><td>78.4500</td><td>0.5277</td><td>0.0726</td><td>0.1517</td><td>0.5100</td></tr><tr><td>A2</td><td>风化</td><td>37.7500</td><td>0.5298</td><td>0.0728</td><td>0.1523</td><td>0.0728</td></tr><tr><td>A3</td><td>无风化</td><td>31. 9500</td><td>0.5239</td><td>1.3600</td><td>0.1506</td><td>0.0720</td></tr><tr><td>A4</td><td>无风化</td><td>35.4700</td><td>0.5240</td><td>0.7900</td><td>0.1507</td><td>0.0721</td></tr><tr><td>A5</td><td>风化</td><td>64.2900</td><td>1.2000</td><td>0.3700</td><td>0.4900</td><td>0.0716</td></tr><tr><td>A6</td><td>风化</td><td>93.1700</td><td>0.5278</td><td>1. 3500</td><td>0.1517</td><td>0.0726</td></tr><tr><td>A7</td><td>风化</td><td>90.8300</td><td>0.5281</td><td>0.9800</td><td>0.1518</td><td>0.1100</td></tr><tr><td>A8</td><td>无风化</td><td>51. 1200</td><td>0.5248</td><td>0.2300</td><td>0.1509</td><td>2.2600</td></tr></table>

<!-- Media -->

因成分数据相加需为 100 ,故利用相对信息对数据进一步处理. 其中相对信息是指成分数据仅有的信息反映在成分间的比率中, 与每个成分的绝对数据是无关的. 因为成分数据的每个成分乘以相同的正常数, 成分间的比率是不变的, 因此成分数据可以看作等价类, 且类中数据含有相同的信息, 可以通过适合的尺度因子表示为相同比例向量. 闭合运算是对初始向量乘以合适的尺度因子,使得闭合后的成分和为常数 $k$ (这里为 100 ),定义为

$$
C\left( \mathbf{x}\right)  = C{\left( {x}_{1},{x}_{2},\cdots ,{x}_{D}\right) }^{\mathrm{T}} = {\left( k \cdot  {x}_{1}/\mathop{\sum }\limits_{{i = 1}}^{D}{x}_{i},k \cdot  {x}_{2}/\mathop{\sum }\limits_{{i = 1}}^{D}{x}_{i},\cdots ,k \cdot  {x}_{D}/\mathop{\sum }\limits_{{i = 1}}^{D}{x}_{i}\right) }^{\mathrm{T}}. \tag{3}
$$

对于任意两个向量 $x,y \in  {\mathbf{R}}_{ + }^{D}$ ,如果 $C\left( x\right)  = C\left( y\right)$ ,则 $x$ 和 $y$ 是成分等价的. 故将每个玻璃文物化学成分乘以计算出的相应因子得到最终数据.

<!-- Media -->

表 5 虚拟变量处理表

<table><tr><td>变量</td><td>处理结果</td><td>变量</td><td>处理结果</td></tr><tr><td>纹饰 A</td><td>1</td><td>浅蓝色</td><td>1</td></tr><tr><td>纹饰 B</td><td>2</td><td>深蓝色</td><td>2</td></tr><tr><td>纹饰 C</td><td>3</td><td>蓝绿色</td><td>3</td></tr><tr><td>铅钡</td><td>1</td><td>浅绿色</td><td>4</td></tr><tr><td>高钾</td><td>2</td><td>深绿色</td><td>5</td></tr><tr><td>无风化</td><td>0</td><td>绿色</td><td>6</td></tr><tr><td>风化</td><td>1</td><td>紫色</td><td>7</td></tr><tr><td>黑色</td><td>8</td><td/><td/></tr></table>

<!-- Media -->

## 3 模型建立与求解

### 3.1 问题 1

#### 3.1.1 玻璃表面风化与纹饰、玻璃类型、颜色的相关性分析

首先进行 Spearman 相关系数分析. 在分析之前对定性数据进行虚拟变量处理, 见表 5 . 利用 SPSS 软件分别对纹饰、玻璃类型、颜色与表面风化进行 Spearman 相关性检验, 结果见表 6 . 表 6 结果表明, 纹饰、颜色与表面是否风化无相关关系, 而玻璃类型与其存在相关关系.

<!-- Meanless: - 65 . (C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net-->




<!-- Meanless: - 教学与竞赛· 基于成分数据的古代玻璃制品分析与分类 2023 年 6 月-->

<!-- Media -->

表 6 其他变量与表面风化相关性表

<table><tr><td/><td>纹饰</td><td>表面风化</td><td/><td>玻璃类型</td><td>表面风化</td><td/><td>颜色</td><td>表面风化</td></tr><tr><td>纹饰</td><td>1.000</td><td>0.080</td><td>玻璃类型</td><td>1.000</td><td>-0.301</td><td>颜色</td><td>1.000</td><td>0.088</td></tr><tr><td>表面风化</td><td>0.080</td><td>1.000</td><td>表面风化</td><td>-0.301</td><td>1.000</td><td>表面风化</td><td>0.088</td><td>1.000</td></tr></table>

<!-- Media -->

其次, 为保证结果的可信度, 利用卡方检验对数据进行分析, 在分析之前对数据进行频数统计, 见图 1-图 3.

<!-- Media -->

<!-- figureText: 40 风化 30 频数 20 10 无风化 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_3.jpg?x=169&y=523&w=387&h=245&r=0"/>

图 1 纹饰与表面风化的频数统计

<!-- figureText: 30 风化 ■ 高钾 20 10 0 无风化 ☐铅钡 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_3.jpg?x=601&y=523&w=391&h=238&r=0"/>

图 2 玻璃类型与表面风化的频数统计

<!-- figureText: 25 浅绿 深绿 绿 紫 黑 ■ 风化 20 频数 浅蓝 深蓝 蓝绿 $\square$ 无风化 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_3.jpg?x=1029&y=523&w=463&h=229&r=0"/>

图 3 颜色与表面风化的频数统计

<!-- Media -->

由图 1 可知,在无风化与风化两种情况下,纹饰类型 $\mathrm{A}\text{、}\mathrm{\;B}\text{、}\mathrm{C}$ 变化差异较小,故可初步推断表面风化与纹饰类型无关; 由图 2 可知, 风化与无风化相比, 铅钡玻璃类型占比增加, 高钾玻璃类型占比减少,且变化幅度较大,故可初步推断表面风化与玻璃类型有关；由图 3 可知, 风化与无风化相比, 各种颜色变化较小, 故可初步推断表面风化与颜色无关.

<!-- Media -->

表 7 卡方检验结果表

<table><tr><td>变量</td><td>卡方检验 $p$ 值</td></tr><tr><td>纹饰与表面风化</td><td>0.085</td></tr><tr><td>玻璃类型与表面风化</td><td>0.024</td></tr><tr><td>颜色与表面风化</td><td>0.325</td></tr></table>

<!-- Media -->

为进一步验证推断是否合理, 利用 SPSS 软件进行卡方检验, 结果见表 7.

因只有玻璃类型与表面风化的卡方检验 $p$ 值小于 0.05, 故玻璃类型与表面风化有相关关系, 纹饰、颜色与表面风化的卡方检验 $p$ 值均大于 0.05,故纹饰、颜色与表面风化无相关关系.

#### 3.1.2 不同类型玻璃表面有无风化时化学成分含量的统计规律分析

运用附表 2 处理后的成分数据进行分析, 分别计算出铅钡、高钾玻璃的无风化与风化检测点数据均值. 具体计算方法如下.

因成分数据为几何结构, 故可对其进行扰动运算 (类似实数空间上的加法运算). 对于任意成分数据 $\mathbf{x} = {\left( {x}_{1},{x}_{2},\cdots ,{x}_{D}\right) }^{\mathrm{T}},\mathbf{y} = {\left( {y}_{1},{y}_{2},\cdots ,{y}_{D}\right) }^{\mathrm{T}} \in  {S}^{D},\mathbf{x}$ 与 $\mathbf{y}$ 的扰动运算定义为:

$$
\mathbf{x} \oplus  \mathbf{y} = C{\left( {x}_{1}{y}_{1},{x}_{2}{y}_{2},\cdots ,{x}_{D}{y}_{D}\right) }^{\mathrm{T}} \in  {S}^{D}. \tag{4}
$$

由扰动运算可进一步计算均值. 运用 $\mathrm{R}$ 语言对成分数据进行均值计算,结果如表 8 所示 (仅列出部分化学成分).

<!-- Media -->

表 8 高钾玻璃、铅钡玻璃风化与无风化均值表 (部分)

<table><tr><td>类型</td><td>${\mathrm{{SiO}}}_{2}$</td><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>${\mathrm{{SnO}}}_{2}$</td><td>${\mathrm{{SO}}}_{2}$</td></tr><tr><td>高钾未风化</td><td>74.9529</td><td>0.8818</td><td>7.2326</td><td>0.2110</td><td>0.1234</td></tr><tr><td>高钾风化</td><td>93.6615</td><td>0.5268</td><td>0.3579</td><td>0.1515</td><td>0.0724</td></tr><tr><td>铅钡未风化</td><td>59.5046</td><td>1.3090</td><td>0.1851</td><td>0.1871</td><td>0.0953</td></tr><tr><td>铅钡风化</td><td>27.0317</td><td>0.7432</td><td>0.1502</td><td>0.2105</td><td>0.1745</td></tr></table>

<!-- Media -->

为更直观地观察化学成分的变化, 将结果可视化, 如图 4 和图 5 所示. 其中, 外圈为风化, 内圈为无风化.

对于高钾玻璃,由图 4 可知风化后 ${\mathrm{{SiO}}}_{2}$ 占比增加较大, ${\mathrm{K}}_{2}\mathrm{O}$ 显著减少, ${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$ 和 $\mathrm{{CaO}}$ 占比均有所下降; 对于铅钡玻璃,由图 5 可知风化与无风化相比 ${\mathrm{{SiO}}}_{2}$ 占比降低, $\mathrm{{PbO}}\text{、}\mathrm{{BaO}}\text{、}{\mathrm{P}}_{2}{\mathrm{O}}_{5}$ 和 $\mathrm{{CaO}}$ 占比升高.

(C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net

<!-- Meanless: · 66 ·-->




<!-- Meanless: 第 12 卷 第 2 期 数学建模及其应用 Vol. 12 No. 2 Jun. 2023-->

<!-- Media -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_4.jpg?x=282&y=218&w=503&h=431&r=0"/>

图 4 高钾玻璃风化前后元素对比图 (彩图见封三)

<!-- figureText: - ${\mathrm{{SiO}}}_{2}$ $\square {\mathrm{{Na}}}_{2}\mathrm{O}$ - ${\mathrm{K}}_{2}\mathrm{O}$ - CaO - MgO - PbO $\square \mathrm{{BaO}}$ -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_4.jpg?x=955&y=218&w=511&h=433&r=0"/>

图 5 铅钡玻璃风化前后元素对比图 (彩图见封三)

<!-- Media -->

#### 3.1.3 风化前化学成分预测

首先对附表 1 中的数据进行取虚拟变量处理, 见表 5 ; 再将附表 1 中的变量作为自变量, 附表 2 中的化学成分作为因变量, 作 Dirichlet 回归. 得到回归模型后, 将自变量中的风化 (1) 替换为未风化 (0), 得到预测结果, 如表 9 所示 (因预测结果数据量较大, 故此处只给出了部分预测结果).

<!-- Media -->

表 9 预测风化前的化学成分含量表 (部分) %

<table><tr><td>文物编号</td><td>${\mathrm{{SiO}}}_{2}$</td><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>${\mathrm{{SnO}}}_{2}$</td><td>${\mathrm{{SO}}}_{2}$</td></tr><tr><td>02</td><td>32.812</td><td>2.525</td><td>1.359</td><td>1.016</td><td>0.883</td></tr><tr><td>07</td><td>72.503</td><td>1.816</td><td>2.830</td><td>0.944</td><td>0.813</td></tr><tr><td>08</td><td>46.822</td><td>2.567</td><td>1.677</td><td>1.234</td><td>0.964</td></tr><tr><td>57</td><td>43.538</td><td>2.406</td><td>1.253</td><td>1.099</td><td>0.972</td></tr><tr><td>58</td><td>41.464</td><td>2.301</td><td>1.070</td><td>1.025</td><td>0.963</td></tr></table>

<!-- Media -->

### 3.2 问题 2

#### 3.2.1 玻璃的分类规律分析

决策树是根据已有样本的信息与现有分类, 基于信息熵下降最快的原则, 通过不断训练样本选择分类特征,最终得出包含节点与有向边的树状分类模型,可根据此模型对样本类别进行判断 ${}^{\left\lbrack  {11}\right\rbrack  }$ . 该方法易于理解且便于结果可视化, 同时对于小样本具有很好的分类效果. 考虑到本文样本量较小且需要选择不同类型玻璃的分类特征, 故选用决策树模型.

在进行建模之前首先要对成分数据进行中心对数比 (centered log-ratio, CLR) 变换. 对于任意成分数据 $\mathbf{x} = {\left( {x}_{1},{x}_{2},\cdots ,{x}_{D}\right) }^{\mathrm{T}} \in  {S}^{D}$ ,clr 变换将 $\mathbf{x} \in  {S}^{D}$ 变换为 ${\mathbf{R}}^{D}$ 上的系数,clr 系数为

$$
\operatorname{clr}\left( \mathbf{x}\right)  = {\left( \log \frac{{x}_{1}}{{g}_{\mathrm{m}}\left( \mathbf{x}\right) },\log \frac{{x}_{2}}{{g}_{\mathrm{m}}\left( \mathbf{x}\right) },\cdots ,\log \frac{{x}_{D}}{{g}_{\mathrm{m}}\left( \mathbf{x}\right) }\right) }^{\mathrm{T}}. \tag{5}
$$

记 $\mathrm{{clr}}$ 变换后的数据为 $\operatorname{clr}\left( \mathbf{x}\right)  = \mathbf{\xi } = {\left( {\xi }_{1},{\xi }_{2},\cdots ,{\xi }_{D}\right) }^{\mathrm{T}}$ ,则 $\mathrm{{clr}}$ 逆变换为

$$
\mathbf{x} = {\operatorname{clr}}^{-1}\left( \mathbf{\xi }\right)  = C{\left( \exp \left\{  {\mathbf{\xi }}_{1}\right\}  ,\exp \left\{  {\mathbf{\xi }}_{2}\right\}  ,\cdots ,\exp \left\{  {\mathbf{\xi }}_{D}\right\}  \right) }^{\mathrm{T}}, \tag{6}
$$

用转化后的成分数据建立分类模型. 为使分类结果直观明了, 本文使用决策树模型对其进行特征的选择,进一步探究主要分类特征,从而推断两种玻璃的分类规律. 在此模型中,将风化、 ${\mathrm{{SiO}}}_{2}\text{、}{\mathrm{{Na}}}_{2}\mathrm{O}$ 、 ${\mathrm{K}}_{2}\mathrm{O}\text{、}\mathrm{{CaO}}\text{、}\mathrm{{MgO}}\text{、}{\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}\text{、}{\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}\text{、}\mathrm{{CuO}}\text{、}\mathrm{{PbO}}\text{、}\mathrm{{BaO}}\text{、}{\mathrm{P}}_{2}{\mathrm{O}}_{5}\text{、}\mathrm{{SrO}}\text{、}{\mathrm{{SnO}}}_{2}$ 和 ${\mathrm{{SO}}}_{2}$ 作为分类特征,将玻璃的类型作为类别构建决策树模型,且将 67 个样本划分为训练集与测试集,其中 47 个样本为训练集, 剩余则为测试集. 最后采用 $\mathrm{R}$ 语言进行软件实现,结果如图 6 所示. 再用测试集进行预测, 正确率为 100%.

<!-- Media -->

<!-- figureText: 铅钡 .00 1.00 氧化铅.PbO. < 1.3 · 68% 2 铅钡 高钾 .32 .68 1.00 .00 100% 32% Rattle 2023-1月-08 20:05:49 86159 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_4.jpg?x=978&y=1924&w=540&h=202&r=0"/>

图 6 决策树结果

<!-- Media -->

由图 6 可知,最终以 $\mathrm{{PbO}}$ 为特征进行两类玻璃分类,若 $\mathrm{{PbO}}$ 值大于 1.3 则为铅钡玻璃,反之为高钾玻璃.

<!-- Meanless: - 67 . (C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net-->




<!-- Meanless: - 教学与竞赛· 基于成分数据的古代玻璃制品分析与分类 2023 年 6 月-->

偏最小二乘判别分析是一种有监督的判别分析方法, 可视为回归模型的扩展, 主要用于多变量分析技术中的判别分析 ${}^{\left\lbrack  {12}\right\rbrack  }$ . 与偏最小二乘回归相比,偏最小二乘判别分析仅需 1 个数据集,但需要提前知道数据的标签, 其余与偏最小二乘回归原理相同 ${}^{\left\lbrack  {13}\right\rbrack  }$ . 在此模型中, 因变量为给定的类标签, 自变量与传统回归模型相同, 用此回归结果可推断出对因变量分类有较大影响的特征, 从而可根据该模型对新给定的样本进行所属类别判断. 通过计算不同变量的投影重要性 (VIP) 可反映每个变量的加载权重以及其对因变量的解释程度, 从而通过该方法选择出对分类有较大影响的变量[14].

下面采用偏最小二乘判别分析对高钾玻璃和铅钡玻璃进行分类. 由于 $\mathrm{{clr}}$ 变换后数据求和为 0,以玻璃类型为分类变量, 风化、化学成分为特征变量, 建立偏最小二乘判别分析, 结果如图 7 所示, 分析模型验证结果如图 8 所示. 由图 7 可知, 高钾玻璃和铅钡玻璃有明显的分离趋势. 由图 8 可知, Q2 左侧交于 $Y$ 轴负半轴,说明模型构建成功.

<!-- Media -->

<!-- figureText: 2 高钾玻璃 铅钡玻璃 2 4 第二主成分 1 -2 -3 8 -6 -4 -2 0 第一主成分 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_5.jpg?x=160&y=696&w=647&h=355&r=0"/>

图 7 偏最小二乘判别分析结果

<!-- figureText: 模型解释能力 模型预测能力 0.6 0.8 相关性 0.8 0.6 0.4 取值 0.2 0 -0.2 0.2 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_5.jpg?x=914&y=696&w=497&h=357&r=0"/>

图 8 偏最小二乘判别分析模型验证

<!-- Media -->

计算不同变量的投影重要性 VIP 值, 结果如表 10 所示. 筛选 VIP 值大于 1 的特征, 对于分类有影响的特征为 $\mathrm{{PbO}}\text{、}{\mathrm{K}}_{2}\mathrm{O}\text{、}\mathrm{{BaO}}$ 和 $\mathrm{{SrO}}$ . 上面图表结果是在 simca 软件操作完成.

<!-- Media -->

表 10 偏最小二乘判别分析的不同特征的 VIP 值

<table><tr><td>变量</td><td>VIP</td><td>变量</td><td>VIP</td></tr><tr><td>风化</td><td>0.2098</td><td>CuO</td><td>0.5694</td></tr><tr><td>${\mathrm{{SiO}}}_{2}$</td><td>0.8907</td><td>PbO</td><td>2. 4614</td></tr><tr><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>0.1203</td><td>BaO</td><td>1.3472</td></tr><tr><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>1. 8000</td><td>${\mathrm{P}}_{2}{\mathrm{O}}_{5}$</td><td>0.1226</td></tr><tr><td>CaO</td><td>0.5095</td><td>SrO</td><td>1.1113</td></tr><tr><td>$\mathrm{{MgO}}$</td><td>0.3871</td><td>${\mathrm{{SnO}}}_{2}$</td><td>0.3548</td></tr><tr><td>${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$</td><td>0.6157</td><td>${\mathrm{{SO}}}_{2}$</td><td>0.1247</td></tr><tr><td>${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$</td><td>0.7284</td><td/><td/></tr></table>

<!-- Media -->

#### 3.2.2 亚类划分方法结果及敏感性分析

K-means 是一种根据样本距离将样本分类的无监督学习方法,首先把样品随机分成 $k$ 个初始类; 再不断进行修改迭代最终将样品分到其最近均值的类中去. 其中样本间的距离测算采用欧氏距离. 欧式距离公式为：

$$
{d}_{ij}^{2} = \mathop{\sum }\limits_{{k = 1}}^{p}{\left( {x}_{ik} - {x}_{jk}\right) }^{2}. \tag{7}
$$

将两类玻璃分别进行更进一步的亚类划分. 本次划分并不知亚类划分的结果, 该批数据并未有明确的类型, 因此该类问题为无监督学习问题, 对其进行聚类分析.

首先需要选择所分类别的个数,采用 $\mathrm{R}$ 语言中的 fviz_nbclust 函数进行判断,结果如图 9 和图 10 所示. 根据其间断点可知两种玻璃的亚分类最终均选取 3 类.

<!-- Media -->

<!-- figureText: 600 8 10 聚类个数 组内平方和 500 400 300 200 6 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_5.jpg?x=237&y=1817&w=490&h=320&r=0"/>

图 9 高钾分类个数确定

<!-- figureText: 600 10 12 14 聚类个数 组内平方和 300 200 2 4 6 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_5.jpg?x=928&y=1817&w=486&h=320&r=0"/>

图 10 铅钡分类个数确定

<!-- Media -->

(C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net

<!-- Meanless: · 68 ·-->




<!-- Meanless: 第 12 卷 第 2 期 数学建模及其应用 Vol. 12 No. 2 Jun. 2023-->

其次, 在确定聚类个数的情况下用 K-means 进行聚类, 结果如图 11 和图 12 所示.

<!-- Media -->

<!-- figureText: 2 0 2 成分 1 1 成分2 0 -1 -2 -3 -4 -2 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_6.jpg?x=261&y=277&w=531&h=268&r=0"/>

图 11 高钾聚类情况

<!-- figureText: 成分2 0 成分 1 -2 -4 -2 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_6.jpg?x=951&y=277&w=529&h=272&r=0"/>

图 12 铅钡聚类情况

<!-- Media -->

由图 11、图 12 可知铅钡玻璃可被明显地分为 3 类, 故其亚分类包含 3 类; 高钾玻璃 3 类划分并未有非常明显的类别, 仅可粗略将其分为 3 类, 如表 11 所示.

<!-- Media -->

表 11 亚分类

<table><tr><td>玻璃类型</td><td>亚分类</td><td>文物编号</td></tr><tr><td/><td>1</td><td>06 部位 1,18</td></tr><tr><td>高钾</td><td>2</td><td>21,07,09,10,12,22,27</td></tr><tr><td>玻璃</td><td>3</td><td>01, 03 部位 1, 03 部位 2, 04, 05, 06 部位 2, 13, 14, 16</td></tr><tr><td/><td>1</td><td>20,37,50未风化点,08,08严重风化,11,19,26,26严重风化,39,40,43部位 2, 50, 51 部位 1, 52, 54, 54 严重风化, 56, 58</td></tr><tr><td>铅钡</td><td>2</td><td>28 未风化点, 29 未风化点, 30 部位 1, 30 部位 2, 31, 32, 35, 49 未风化点, 02, 41, 48, 49, 51 部位 2</td></tr><tr><td>玻璃</td><td>3</td><td>23 未风化点, 24, 25 未风化点, 33, 42 未风化点 1, 42 未风化点 2, 44 未风化点, 45, 46, 47, 53 未风化点, 55,34,36,38,43部位 1,57</td></tr></table>

<!-- Media -->

在确定分类个数时, 不同的选择会出现不同的结果, 故应对此模型的敏感性进行分析. 因高钾玻璃并未有明显的分类效果, 故尝试多种分类个数进行聚类, 从而选择出较优的聚类情况.

下面对每类玻璃的亚类划分选择合适的化学成分.

对于高钾玻璃, 亚类划分为 3 类. 由于其中一类只有两种文物玻璃, 因此删除这一类文物, 以其余类为分类变量, 化学成分为特征, 构建偏最小二乘判别分析, 如图 13 和图 14 所示. 由图 13 可知, 高钾玻璃的亚类有明显的分离趋势. 由图 14 可知, $\mathrm{Q}2$ 左侧交于 $Y$ 轴负半轴,说明模型构建成功.

<!-- Media -->

<!-- figureText: 2 亚二类 亚三类 2 4 第二主成分 1 0 -1 -2 6 -4 -2 0 第一主成分 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_6.jpg?x=217&y=1416&w=618&h=359&r=0"/>

图 13 高钾玻璃亚类偏最小二乘判别分析结果

<!-- figureText: ● 模型解释能力 - 模型预测能力 0.6 0.8 1.0 相关性 0.8 0.6 取值 0.4 0.2 -0.2 0.2 0.4 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_6.jpg?x=934&y=1414&w=560&h=354&r=0"/>

图 14 高钾玻璃亚类偏最小二乘判别分析模型验证

<!-- Media -->

计算不同变量的 VIP 值, 结果见表 12. 筛选 VIP 值大于 1 的特征, 表明对于高钾玻璃亚类分类有影响的特征分别为 ${\mathrm{K}}_{2}\mathrm{O}\text{、}{\mathrm{{SiO}}}_{2}\text{、}\mathrm{{CaO}}\text{、}{\mathrm{{SnO}}}_{2}$ 和 $\mathrm{{BaO}}$ .

<!-- Media -->

表 12 高钾玻璃亚类偏最小二乘判别分析的不同特征的 VIP 值表

<table><tr><td>变量</td><td>VIP</td><td>变量</td><td>VIP</td><td>变量</td><td>VIP</td><td>变量</td><td>VIP</td></tr><tr><td>${\mathrm{{SiO}}}_{2}$</td><td>1. 5267</td><td>$\mathrm{{CuO}}$</td><td>0.7509</td><td>MgO</td><td>0.0216</td><td>SrO</td><td>0.4147</td></tr><tr><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>0.3815</td><td>PbO</td><td>0.2068</td><td>${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$</td><td>0.4654</td><td>${\mathrm{{SnO}}}_{2}$</td><td>1. 2763</td></tr><tr><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>2.3016</td><td>BaO</td><td>1. 2158</td><td>${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$</td><td>0.5235</td><td>${\mathrm{{SO}}}_{2}$</td><td>0.3721</td></tr><tr><td>CaO</td><td>1.3078</td><td>${\mathrm{P}}_{2}{\mathrm{O}}_{5}$</td><td>0.0160</td><td/><td/><td/><td/></tr></table>

<!-- Media -->

<!-- Meanless: · 69 · (C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net-->




<!-- Meanless: - 教学与竞赛· 基于成分数据的古代玻璃制品分析与分类 2023 年 6 月-->

对于铅钡玻璃, 亚类划分为 3 类. 以这 3 类为分类变量, 化学成分为特征, 构建偏最小二乘判别分析, 结果如图 15 和 16 所示. 由图 15 可知, 铅钡玻璃的 3 类有明显的分离趋势. 由图 16 可知, Q2 左侧交于 $Y$ 轴负半轴,说明模型构建成功.

<!-- Media -->

<!-- figureText: 第二主成分 -2 亚类1 亚类2 亚类3 1 2 第一主成分 -3 -4 -5 -5 -4 -2 -1 0 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_7.jpg?x=196&y=369&w=570&h=338&r=0"/>

图 15 铅钡玻璃亚类偏最小二乘判别分析结果

<!-- figureText: ● 模型解释能力 I 模型预测能力 0.5 0.6 ).70.8 0.9 1.0 相关性 0.6 0.4 0.3 取值 0.2 0.1 -0.1 -0.2 -0.3 0.1 0.2 0.3 0.4 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_7.jpg?x=919&y=368&w=505&h=339&r=0"/>

图 16 铅钡玻璃亚类偏最小二乘判别分析模型验证

<!-- Media -->

计算不同变量的 VIP 值, 结果见表 13. 筛选 VIP 值大于 1 的特征, 对于铅钡玻璃亚类分类有影响的特征分别为 ${\mathrm{P}}_{2}{\mathrm{O}}_{5}$ 、 $\mathrm{{CuO}}$ 、 ${\mathrm{{Na}}}_{2}\mathrm{O}$ 和 ${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$ .

<!-- Media -->

表 13 铅钡玻璃亚类偏最小二乘判别

分析的不同特征的 VIP 值表

<table><tr><td>变量</td><td>VIP</td><td>变量</td><td>VIP</td></tr><tr><td>${\mathrm{{SiO}}}_{2}$</td><td>0.9550</td><td>CuO</td><td>1.3711</td></tr><tr><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>1. 3046</td><td>PbO</td><td>0.2813</td></tr><tr><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>0.5825</td><td>BaO</td><td>0.8605</td></tr><tr><td>CaO</td><td>0.6696</td><td>${\mathrm{P}}_{2}{\mathrm{O}}_{5}$</td><td>2.0512</td></tr><tr><td>$\mathrm{{MgO}}$</td><td>0.7716</td><td>SrO</td><td>0.4435</td></tr><tr><td>${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$</td><td>0.8339</td><td>${\mathrm{{SnO}}}_{2}$</td><td>0.4663</td></tr><tr><td>${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$</td><td>1. 2119</td><td>${\mathrm{{SO}}}_{2}$</td><td>0.7193</td></tr></table>

<!-- Media -->

### 3.3 问题 3

方法一: 表单 3 中未知玻璃类型的类别划分. 基于决策树的结果, 以 PbO 为特征进行分类, 若 PbO 值大于 1.5 则为铅钡玻璃,反之为高钾玻璃. 结果表明, A1、A6、A7 为高钾玻璃, A2、A3、A4、A5、A8 为铅钡玻璃.

方法二: 选取问题 2 中对于高钾玻璃和铅钡玻璃筛选的特征 $\mathrm{{PbO}}\text{、}{\mathrm{K}}_{2}\mathrm{O}\text{、}\mathrm{{BaO}}$ 和 $\mathrm{{SrO}}$ ,建立这 4 个特征与玻璃类型的偏最小二乘回归分析, 其中因变量玻璃类型中高钾玻璃取值为 1, 铅钡玻璃取值为 0 .

基于交叉验证方法计算预测均方根误差, 使用所有主成分进行回归. 得到的结果如表 14 所示.

<!-- Media -->

表 14 不同主成分个数下偏最小二乘回归结果表

<table><tr><td>评价准则</td><td>1 个</td><td>2 个</td><td>3 个</td><td>4 个</td></tr><tr><td>交叉验证的预测均方根误差</td><td>0.1471</td><td>0.1389</td><td>0.1371</td><td>0.1372</td></tr><tr><td>调整的交叉验证的预测均方根误差</td><td>0.1470</td><td>0.1381</td><td>0.1365</td><td>0.1365</td></tr><tr><td>累计贡献率/%</td><td>80.19</td><td>87. 15</td><td>93.55</td><td>100</td></tr></table>

<!-- Media -->

从回归结果可以看出, 主成分个数为 3 时, 模型在经交叉验证后得到的预测均方根误差最小, 同时 3 个主成分对各变量的累计贡献率已经达到 93%,因此将偏最小二乘回归的主成分个数设定为 3 .

主成分个数确定后,计算得到 $\mathrm{{PbO}}\text{、}{\mathrm{K}}_{2}\mathrm{O}\text{、}\mathrm{{BaO}}$ 和 $\mathrm{{SrO}}$ 的偏最小二乘回归系数分别为 0.0134、 $- {0.1582}\text{、} - {0.0288}$ 和-0.0206.

将表单 3 中 $\mathrm{{PbO}}\text{、}{\mathrm{K}}_{2}\mathrm{O}\text{、}\mathrm{{BaO}}$ 和 $\mathrm{{SrO}}$ 的数据代入偏最小二乘回归模型,得到不同文物的预测值, 若预测值接近 1 , 为高钾玻璃; 预测值接近 0 , 为铅钡玻璃. 预测结果见表 15 .

通过上述分析, 可以看出两种方法预测结果一致.

<!-- Media -->

表 15 表单 3 未知玻璃文物的类型预测

<table><tr><td>文物编号</td><td>预测值</td><td>预测玻璃类型</td></tr><tr><td>A1</td><td>1.0408</td><td>高钾</td></tr><tr><td>A2</td><td>0.0177</td><td>铅钡</td></tr><tr><td>A3</td><td>0.0980</td><td>铅钡</td></tr><tr><td>A4</td><td>0.1898</td><td>铅钡</td></tr><tr><td>A5</td><td>0.2558</td><td>铅钡</td></tr><tr><td>A6</td><td>0.9615</td><td>高钾</td></tr><tr><td>A7</td><td>0.9631</td><td>高钾</td></tr><tr><td>A8</td><td>0.1122</td><td>铅钡</td></tr></table>

<!-- Media -->

为了更进一步分析高钾玻璃与铅钡玻璃的亚类划分, 基于上述亚类划分结果:

1) 对于高钾玻璃,以 3 个亚类为因变量,化学成分 ${\mathrm{K}}_{2}\mathrm{O}$ 、 ${\mathrm{{SiO}}}_{2}$ 、 $\mathrm{{CaO}}$ 、 ${\mathrm{{SnO}}}_{2}$ 和 $\mathrm{{BaO}}$ 为自变量,建立偏最小二乘回归, 通过交叉验证确定主成分个数为 2 , 对表单 3 中 A1、A6 和 A7 文物进行预测, 结果表明 A1、A6 和 A7 都是高钾玻璃的同一亚类;

2) 对于铅钡玻璃,以 3 个亚类为因变量,化学成分 ${\mathrm{P}}_{2}{\mathrm{O}}_{5}$ 、

(C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net $\mathrm{{CuO}}\text{、}{\mathrm{{Na}}}_{2}\mathrm{O}$ 和 ${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$ 为自变量,建立偏最小二乘回归,通过交叉验证确定主成分个数为 2,对表单 3 中 $\mathrm{A}2\text{、}\mathrm{\;A}3\text{、}\mathrm{\;A}4\text{、}\mathrm{\;A}5$ 和 $\mathrm{A}8$ 文物进行预测,结果表明 $\mathrm{A}2$ 和 $\mathrm{A}4$ 是铅钡玻璃的同一亚类, $\mathrm{A}3$ 和 $\mathrm{A}8$ 是铅钡玻璃的同一亚类, A5 是铅钡玻璃的另一亚类.

<!-- Meanless: ·70·-->




<!-- Meanless: 第 12 卷 第 2 期 数学建模及其应用 Vol. 12 No. 2 Jun. 2023-->

### 3.4 问题 4

#### 3.4.1 相关性分析

灰色系统着重内涵不明确的对象, 将不确定的 “灰” 转化为可解读的 “白” 信息 ${}^{\left\lbrack  {15}\right\rbrack  }$ . 其中灰色关联通过序列曲线集合形状可直观地对关联度进行分析.

将玻璃按照高钾玻璃与铅钡玻璃分类讨论. 因为题中要求分析不同类别文物化学成分之间的关联关系, 且变量较多, 热力图更可直观地体现两两化学成分之间的相关关系, 故分别制作高钾玻璃与铅钡玻璃的化学元素热力图, 如图 17 所示.

<!-- Media -->

<!-- figureText: SiO 1.0 ${\mathrm{{SiO}}}_{2}$ 1.0 ${\mathrm{{Na}}}_{2}\mathrm{O}$ 0.8 0.6 CaO 0.4 MgO ${\mathrm{{Al}}}_{2}\mathrm{O}$ , 0.2 ${\mathrm{{Fe}}}_{2}\mathrm{O}$ , 0 CuO -0.2 PbO BaO -0.4 ${\mathrm{P}}_{2}{\mathrm{O}}_{5}$ -0.6 SrO -0.8 ${\mathrm{{SnO}}}_{2}$ -1.0 (b) 铅钡玻璃热力图 ${\mathrm{{Na}}}_{2}\mathrm{O}$ 0.8 0.6 CaO 0.4 MgO ${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$ 0.2 ${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$ 0 CuO -0.2 PbO BaO -0.4 ${\mathrm{P}}_{2}{\mathrm{O}}_{5}$ -0.6 SrO -0.8 ${\mathrm{{SnO}}}_{2}$ -1.0 (a) 高钾玻璃热力图 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_8.jpg?x=339&y=678&w=1065&h=455&r=0"/>

图 17 高钾与铅钡玻璃热力图

<!-- Media -->

由图 17(a) 可以看出, 按照热力图上方从左到右元素顺序, 每个元素与左右相邻元素相关性较强, ${\mathrm{{SiO}}}_{2}$ 与 $\mathrm{{BaO}}$ 关联性较强,其余两两成分之间关联性相对较弱. 由图 17(b) 可以看出, ${\mathrm{{SnO}}}_{2}\text{、}{\mathrm{{SiO}}}_{2}$ 、 ${\mathrm{{Na}}}_{2}\mathrm{O}$ 、 ${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$ 、 ${\mathrm{K}}_{2}\mathrm{O}$ 、 $\mathrm{{MgO}}$ 、 ${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$ 这 7 个成分两两之间均存在相关性 ( ${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$ 和 ${\mathrm{{Na}}}_{2}\mathrm{O}$ 之间除外). $\mathrm{{CuO}}\text{、}\mathrm{{BaO}}\text{、}{\mathrm{{SO}}}_{2}$ 两两之间均存在较为强烈的相关性.

考虑到玻璃的主要化学成分为 ${\mathrm{{SiO}}}_{2}$ ,故将 ${\mathrm{{SiO}}}_{2}$ 作为母序列,其他化学成分作为子序列, 运用 Matlab 进行灰色关联分析, 最终得出关联度值. 使用关联度值对 49 个评价对象进行排序, 结果如表 16 所示.

<!-- Media -->

表 16 两类玻璃化学成分关联度对比表

<table><tr><td>评价项 (铅钡)</td><td>关联度</td><td>排名</td><td>评价项(高钾)</td><td>关联度</td><td>排名</td></tr><tr><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>0.7904</td><td>11</td><td>${\mathrm{{Na}}}_{2}\mathrm{O}$</td><td>0.6291</td><td>11</td></tr><tr><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>0.9639</td><td>5</td><td>${\mathrm{K}}_{2}\mathrm{O}$</td><td>0.8991</td><td>8</td></tr><tr><td>CaO</td><td>0.8227</td><td>10</td><td>$\mathrm{{CaO}}$</td><td>0.9132</td><td>7</td></tr><tr><td>$\mathrm{{MgO}}$</td><td>0.9205</td><td>9</td><td>$\mathrm{{MgO}}$</td><td>0.8571</td><td>9</td></tr><tr><td>${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$</td><td>0.9603</td><td>6</td><td>${\mathrm{{Al}}}_{2}{\mathrm{O}}_{3}$</td><td>0.9765</td><td>2</td></tr><tr><td>${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$</td><td>0.9278</td><td>8</td><td>${\mathrm{{Fe}}}_{2}{\mathrm{O}}_{3}$</td><td>0.5685</td><td>12</td></tr><tr><td>CuO</td><td>0.6742</td><td>12</td><td>$\mathrm{{CuO}}$</td><td>0.9204</td><td>6</td></tr><tr><td>PbO</td><td>0.9785</td><td>1</td><td>PbO</td><td>0.9577</td><td>4</td></tr><tr><td>BaO</td><td>0.9694</td><td>4</td><td>BaO</td><td>0.5655</td><td>13</td></tr><tr><td>${\mathrm{P}}_{2}{\mathrm{O}}_{5}$</td><td>0.5400</td><td>13</td><td>${\mathrm{P}}_{2}{\mathrm{O}}_{5}$</td><td>0.8341</td><td>10</td></tr><tr><td>SrO</td><td>0.9587</td><td>7</td><td>SrO</td><td>0.9798</td><td>1</td></tr><tr><td>${\mathrm{{SnO}}}_{2}$</td><td>0.9729</td><td>2</td><td>${\mathrm{{SnO}}}_{2}$</td><td>0.9492</td><td>5</td></tr><tr><td>${\mathrm{{SO}}}_{2}$</td><td>0.9698</td><td>3</td><td>${\mathrm{{SO}}}_{2}$</td><td>0.9673</td><td>3</td></tr></table>

<!-- Media -->

关联度值介于 $0 \sim  1$ 之间,该值越大代表其与母序列 ${\mathrm{{SiO}}}_{2}$ 之间的相关性越强. 从表 16 可以看出: 本次 13 个评价项中, 铅钡玻璃中, PbO 的综合评价最高 (关联度为0.9798), ${\mathrm{P}}_{2}{\mathrm{O}}_{5}$ 的综合评价最低(关联度为 0.5400 )；高钾玻璃中, $\mathrm{{SrO}}$ 的综合评价最高 (关联度为 ${0.9785}),\mathrm{{BaO}}$ 的综合评价最低(关联度为 0.5655 ).

#### 3.4.2 差异性分析

比较不同类别之间的化学成分关联关系的差异性. 由于热力图中相关系数为对称矩阵, 因此仅选取高钾玻璃相关系数上三角矩阵与铅钡玻璃相关系数上三角矩阵. 由于每个化学成分之间的相关关系是配对的,因此选取配对样本的非参数 wilcoxon 检验,所得 $p$ 值大于 $\alpha \left( {0.05}\right)$ ,因此不拒绝原假设, 即两种类型玻璃的化学成分之间的关联关系没有显著差异.

<!-- Meanless: - 71 . (C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net-->




<!-- Meanless: - 教学与竞赛· 基于成分数据的古代玻璃制品分析与分类 2023 年 6 月-->

通过 $\mathrm{R}$ 作出关于铅钡玻璃与高钾玻璃的关联度折线图和箱线图,如图 18 所示. 由图 18 可知,高钾玻璃与铅钡玻璃相比分散程度较小, 且通过表 16 的排名可知, 两者的化学成分之间的关联关系没有显著差异, 进一步验证了上述结论.

<!-- Media -->

<!-- figureText: 与 ${\mathrm{{SiO}}}_{2}$ 之间的关联度 0.9 铅钡 与 ${\mathrm{{SiO}}}_{2}$ 之间的关联度 0.9 0.8 0.7 0.6 高钾 高钾 铅钡 (b) 箱线图 0.8 0.6 (a) 折线图 -->

<img src="https://cdn.noedgeai.com/bo_d2euoaref24c73b0bbeg_9.jpg?x=314&y=457&w=1027&h=299&r=0"/>

图 18 铅钡玻璃与高钾玻璃的关联度折线图和箱线图

<!-- Media -->

## 4 模型检验及可靠性分析

### 4.1 针对问题 1 的检验

在解答问题 1 之前, 对表单中数据首先进行预处理. 对于玻璃的化学成分, 近似零值插补后转换为成分数据,化学成分比例和为 100%,数据预处理合理. 对于问题 1 , 考虑到成分数据的特殊结构, 在成分数据单形空间上计算均值, 选择适用于成分数据的 Dirichlet 回归模型, 分析方法相比传统分析方法更加合理.

### 4.2 针对问题 2 的检验

对于问题 2 , 选择两种方法分析高钾玻璃与铅钡玻璃的分类规律, 两种方法结果一致, 进一步验证了分类模型的合理性. 对每类玻璃亚类划分时, 基于 K-means 聚类分析确定了最优聚类个数, 分析结果真实可靠.

### 4.3 针对问题 3 的检验

偏最小二乘回归方法基于交叉验证确定了最优主成分个数. 基于两种方法对未知玻璃文物进行类别预测, 结果一致, 因此预测结果合理.

### 4.4 针对问题 4 的检验

采用 Pearson 相关系数分析化学成分之间的关联关系, 基于 wilcoxon 检验比较两种类型玻璃的化学成分之间关联关系的差异性. 结果真实可靠.

## 5 模型评价与展望

### 5.1 模型的优点

本文基于成分数据对玻璃化学成分进行分析, 并对不同玻璃类型进行分类, 主要优点如下:

1) 采用 Dirichlet 回归模型对风化前的化学成分进行预测;

2)对于玻璃类型的分类,考虑到成分数据求和为 ${100}\%$ 的约束,在模型构建前,首先对化学成分进行 clr 变换,使得成分数据变换为欧式空间上的普通数据;

3) 采用不同分类模型对玻璃类型进行分类, 不同模型结果一致.

### 5.2 模型的缺点

对于问题 4 , 不同玻璃类型的化学成分之间的关联关系, 采用 Pearson 相关系数来说明. 但 Pearson 相关系数只能度量变量之间的线性相关关系, 在使用之前未进行线性相关关系检验.

### 5.3 模型的展望

对于问题 2 , 分析不同玻璃之间的分类规律时, 由于两种类型玻璃的样本量不是很接近, 因此后续可以考虑不平衡样本分类模型, 通过对训练集样本重采样或方法修正来进行分类. 对于问题 4 , 可

(C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net 考虑利用其他相关系数来度量化学成分之间的关联关系, 例如最大距离相关系数、互信息等. 参考文献

<!-- Meanless: · 72 ·-->




<!-- Meanless: 第 12 卷 第 2 期 数学建模及其应用 Vol. 12 No. 2 Jun. 2023-->

[1]赵志强. 新疆巴里坤石人子沟遗址群出土玻璃珠的成分体系与制作工艺研究[D]. 西安：西北大学,2016.

[2] 安家瑶. 玻璃器史话 [M]. 北京：社会科学文献出版社,2011：7-11.

[3]全国大学生数学建模组委会. 2022 “高教社杯” 全国大学生数学建模竞赛赛题[EB/OL]. [2022-09-15]. http:// www. mcm. edu. cn/html_cn/node/5267fe3e6a512bec793d71f2b2061497. html.

[4]干福熹. 中国古代玻璃的起源和发展[J]. 自然杂志, 2006, 28(4): 187-193.

[5]Baxter M J. Exploratory multivariate analysis in archaeology[M]. Edinburgh: Edinburgh University Press, 1994: 48-52.

[6]李青会, 黄教珍, 李飞, 等. 中国出土的一批战国古玻璃样品化学成分的检测[J]. 文物保护与考古科学, 2006, ${18}\left( 2\right)  : 8 - {13}$ .

[7]史美光, 何欧里, 周福征. 一批中国汉墓出土钾玻璃的研究[J]. 硅酸盐学报, 1986, 14(3): 307-313.

[8]史美光, 曲长芝, 张日清, 等. 中国早期玻璃器检验报告[J]. 考古学报, 1984, 4: 449-457.

[9]Pawlowsky-Glahn V, Buccianti A. Compositional data analysis: theory and applications[M]. Chichester: Wiley, 2011.

[10] Pawlowsky-Glahn V, Egozcue J J, Tolosana-Delgado R. Modeling and analysis of compositional data [M]. Chichester: Wiley, 2015.

[11]李航. 统计学习方法[M]. 2 版. 北京：清华大学出版社,2019.

[12]Lee L C, Liong C Y, Jemain A A. Partial least squares-discriminant analysis (PLS-DA) for classification of high-dimensional (HD) data: a review of contemporary practice strategies and knowledge gaps [J]. Analyst, 2018, ${143}\left( {15}\right)  : {3526} - {3539}.$

[13]崔耀耀, 孔德明, 孔令富, 等. 基于重构三维荧光光谱结合偏最小二乘判别分析的油类识别方法研究[J]. 光谱学与光谱分析, 2020, 40(12): 3789-3794.

[14]邱丰, 俞艳文, 魏宇锋, 等. 拉曼光谱法结合偏最小二乘法快速测定柴油十六烷值[J]. 理化检验(化学分册), 2021, 57(10): 885-889.

[15]刘小彩, 韩宗霖, 付宁, 等. 基于灰色关联度的河南省高校 R8-D 影响因素分析[J]. 管理工程师, 2022, 27(5): 58-65. Analysis and Classification of Ancient Glass Products Based on Compositional Data

MA Peiying, HAN Yanlai, LI Delan, CHEN Jiajia

(School of Statistics, Shanxi University of Finance and Economics, Taiyuan, Shanxi 030006, China)

Abstract: The chemical composition of ancient glass products belongs to the compositional data. Therefore, using the compositional data analysis method, the chemical composition of glass products is analyzed and its classification rule is studied, thus the type of unknown glass relics is identified. Firstly, based on Spearman correlation coefficient and Chi-square test, the relationship between surface weathering of glass relics and its type, decoration and color were analyzed; the statistical rule of weathering chemical composition on glass surface was analyzed by means in simplex space; the Dirichlet regression model was constructed to predict the chemical composition before weathering. Secondly, two models of decision tree and partial least squares discriminant analysis were constructed to select the features of the initial classification of the two types of glass; further, K-means clustering was used to sub-classify the two types of glass, and partial least squares discriminant analysis was used to sub-classify the two types of glass; then, the classification rules were used to identify the unknown type of glass. Finally, grey correlation analysis was used to explore the correlation and difference between the two types of glass chemical components.

Key words: compositional data; decision tree; partial least squares discriminant analysis; K-means clustering; grey relation

## 作者简介

马佩莹 (2002一), 女, 山西财经大学统计学院 2020 级本科生.

韩雁来 (2001一),女,山西财经大学统计学院 2020 级本科生.

李德兰 (2001一),女,山西财经大学统计学院 2020 级本科生.

陈佳佳 (1991一), 女, 博士, 副教授, 主要从事数理统计方面的研究.

<!-- Meanless: ·73· (C)1994-2023 China Academic Journal Electronic Publishing House. All rights reserved. http://www.cnki.net-->

